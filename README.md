# –ü—Ä–æ–µ–∫—Ç YaMDb (–°–±–æ—Ä–∫–∞ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)

## –ê–≤—Ç–æ—Ä:

üíª [dazdik](https://github.com/dazdik)

![Alt-—Ç–µ–∫—Å—Ç](https://boxboat.com/2017/06/28/whats-new-in-docker-17-06/featured.png "–ö–∏—Ç –ø–æ –∏–º–µ–Ω–∏ Docker")



## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ REST API –¥–ª—è YaMDb

–°–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ [Django REST Framework (DRF)](https://github.com/ilyachch/django-rest-framework-rusdoc)


–ü—Ä–æ–µ–∫—Ç YaMDb —Å–æ–±–∏—Ä–∞–µ—Ç –æ—Ç–∑—ã–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è—Ö. –†–∞–±–æ—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ¬´–ö–Ω–∏–≥–∏¬ª, ¬´–§–∏–ª—å–º—ã¬ª, ¬´–ú—É–∑—ã–∫–∞¬ª. [–°—Å—ã–ª–∫–∞](https://github.com/dazdik/api_yamdb) –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –ø—Ä–æ–µ–∫—Ç–æ–º.

____

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

- Python 3
- DRF (Django REST framework)
- Django ORM
- Docker
- Gunicorn
- Nginx
- Django 3.2
- PostgreSQL
- GIT
___
## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ üöÄ

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```
https://github.com/dazdik/infra_sp2
```

2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º

```bash
cd infra_sp2
```

3. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é  ```cd infra``` –∏ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env, –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ–≥–æ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–∏–º–µ—Ä—É:

```
DB_ENGINE=django.db.backends.postgresql # —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ–º —Å postgresql
DB_NAME=postgres # –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
POSTGRES_USER=postgres # –ª–æ–≥–∏–Ω –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
POSTGRES_PASSWORD=postgres # –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–≤–æ–π)
DB_HOST=db # –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)
DB_PORT=5432 # –ø–æ—Ä—Ç –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
```
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å docker-compose –∏–∑ –ø–∞–ø–∫–∏ ```infra```
```bash
docker-compose up -d
```
5. –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ web –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏, —Å–æ–∑–¥–∞—Ç—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–æ–±—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É:
```
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py createsuperuser
docker-compose exec web python manage.py collectstatic --no-input
```

üí• –¢–µ–ø–µ—Ä—å –ø—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É http://localhost/admin/

6. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã–º–∏:
```
docker-compose exec web python manage.py loaddata fixtures.json
```
___
### –î—Ä—É–≥–∏–µ –∫–æ–º–∞–Ω–¥—ã
*–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤*:
```
docker stats
```

*–û—Å—Ç–∞–≤–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å–æ –≤—Å–µ–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:*
```
docker-compose down -v
```

*–£–∑–Ω–∞—Ç—å,  —Å–∫–æ–ª—å–∫–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ –∑–∞–Ω–∏–º–∞—é—Ç –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ç–æ–º–∞ –∏ –±–∏–ª–¥-–∫–µ—à:*
```
docker system df 
```

*–í—Å–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ (–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ) –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É–¥–∞–ª—è—é—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:*
```
docker container prune
```

*–£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑—ã, –∫–∞–∫–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –∫–∞–∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ –¥—Ä—É–≥–∏—Ö –æ–±—Ä–∞–∑–æ–≤, –Ω–æ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∏ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:*
```
docker image prune
```

*–£–¥–∞–ª–∏—Ç—å –≤–æ–æ–±—â–µ –≤—Å—ë, —á—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã, –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ç–æ–º–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∏ –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –±–∏–ª–¥-–∫–µ—à), –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:*
```
docker system prune
```